<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>AI Chat Interface ??</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 50px;
        background-color: #f2f2f2;
        position: relative;
      }
      .chat-container {
        background: white;
        padding: 20px;
        border-radius: 10px;
        max-width: 500px;
        margin: auto;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        position: relative;
        z-index: 10;
      }
      h1 {
        text-align: center;
      }
      .input-form {
        display: flex;
        flex-direction: column;
      }
      input[type="text"] {
        padding: 10px;
        margin-top: 10px;
        font-size: 16px;
      }
      input[type="submit"],
      #send-btn {
        margin-top: 10px;
        padding: 10px;
        font-size: 16px;
        background-color: #4caf50;
        color: white;
        border: none;
        cursor: pointer;
      }
      input[type="submit"]:hover,
      #send-btn:hover {
        background-color: #45a049;
      }
      .chaotic-cats {
        position: relative;
        height: 500px;
        margin-top: 50px;
      }
      .cat-card {
        position: absolute;
        width: 200px;
        background: white;
        border: 2px dashed #f50057;
        padding: 5px;
        box-shadow: 0 0 6px rgba(0, 0, 0, 0.2);
        text-align: center;
        font-size: 14px;
        font-weight: bold;
        transform: rotate(-3deg);
      }
      .cat-card img {
        width: 100%;
        border-radius: 5px;
        margin-bottom: 5px;
      }
      /* Position each cat box manually for chaotic layout */
      .cat1 {
        top: 30px;
        left: 8%;
        transform: rotate(-5deg);
      }
      .cat2 {
        top: 80px;
        left: 55%;
        transform: rotate(7deg);
      }
      .cat3 {
        top: 180px;
        left: 30%;
        transform: rotate(-8deg);
      }
      .cat4 {
        top: 160px;
        right: 10%;
        transform: rotate(6deg);
      }
      /* Decorative random elements */
      .random-deco {
        position: absolute;
        font-size: 30px;
        z-index: 0;
        opacity: 0.7;
        user-select: none;
      }
      .deco1 {
        top: 80px;
        left: 50%;
        transform: rotate(-15deg);
        color: gold;
      }
      .deco2 {
        top: 300px;
        right: 50px;
        transform: rotate(25deg);
        color: hotpink;
      }
      .deco3 {
        top: 400px;
        left: 10%;
        transform: rotate(-30deg);
        color: blue;
      }
      .deco4 {
        top: 150px;
        left: 5%;
        transform: rotate(10deg);
        color: limegreen;
      }
      .deco5 {
        top: 20px;
        right: 30%;
        transform: rotate(-20deg);
        color: orange;
      }

      /* Chat message styles */
      #message-history {
        max-height: 300px;
        overflow-y: auto;
        margin-bottom: 15px;
        padding: 10px 0;
      }
      .message-container {
        display: flex;
        margin-bottom: 10px;
        clear: both;
        width: 100%;
      }
      .user-message-container {
        justify-content: flex-end;
      }
      .bot-message-container {
        justify-content: flex-start;
      }
      .user-message {
        background-color: #dcf8c6;
        border-radius: 18px;
        padding: 10px 15px;
        max-width: 70%;
        text-align: right;
        box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
      }
      .bot-message {
        background-color: #eaeaea;
        border-radius: 18px;
        padding: 10px 15px;
        max-width: 70%;
        text-align: left;
        box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
      }
    </style>
  </head>
  <body>
    <div class="chat-container">
      <h1>AI Chat??</h1>
      <div id="message-history"></div>
      <div class="input-form">
        <label for="message-input">Enter a prompt:</label>
        <input
          type="text"
          id="message-input"
          placeholder="e.g. Build a house"
          required
        />
        <button id="send-btn">Send</button>
      </div>
    </div>
    <div class="chaotic-cats">
      <div class="cat-card cat1">
        <img
          src="{{url_for ('static', filename='images/cat1.jpeg') }}"
          alt="Cat 1"
        />
        Lonely Cats Nearby!
      </div>
      <div class="cat-card cat2">
        <img
          src="{{url_for ('static', filename='images/cat3.jpeg') }}"
          alt="Cat 2"
        />
        Single Cat Wants to Play üêæ
      </div>
      <div class="cat-card cat3">
        <img
          src="{{url_for ('static', filename='images/cat2.jpeg') }}"
          alt="Cat 3"
        />
        Click to Meow üòº
      </div>
      <div class="cat-card cat4">
        <img
          src="{{url_for ('static', filename='images/cat4.jpeg') }}"
          alt="Cat 4"
        />
        Less than 5km away!!
      </div>
      <div class="random-deco deco1">‚ú®</div>
      <div class="random-deco deco2">üíñ</div>
      <div class="random-deco deco3">‚≠ê</div>
      <div class="random-deco deco4">üòª</div>
      <div class="random-deco deco5">üåü</div>
    </div>

    <script>
      const messageInput = document.getElementById("message-input");
      const sendBtn = document.getElementById("send-btn");
      const messageHistory = document.getElementById("message-history");

      // Funny responses based on the prompt
      const funnyResponses = {
        house:
          "Your dream house is under construction! It's currently just a square with a triangle roof, but trust me, it'll be HGTV worthy!",
        tower:
          "Tower coming right up! It's very... vertical. Perfect for princesses with extremely long hair or Wi-Fi antennas!",
        village:
          "An entire village? Ambitious! I've created a cozy hamlet with two houses and a lookout tower. Population: your imagination!",
      };

      // Expanded default funny responses
      const defaultFunnyResponses = [
        "Kinda ambitious don't you think? üò≠üôè",
        "Hmm, I'm not sure what to build with that. Maybe try 'house', 'tower', or 'village'? My architectural degree only covered so much! üèóÔ∏è",
        "My builder cats are confused by your request. They're currently taking a nap instead. üò∏üí§",
        "Meow-ch! That's beyond my block-building capabilities! Try something simpler?",
        "Error 404: Construction plan not found. Have you tried turning your creativity off and on again?",
        "I'd love to build that, but my virtual building permit only covers houses, towers, and villages. Bureaucracy, am I right? üôÑ",
        "The blocks union is on strike for that particular request. Maybe try again with 'house', 'tower', or 'village'?",
        "My quantum building algorithm is still processing that request... might take a few centuries! Try 'house' for faster results!",
        "I asked my cat what to build for that and she just knocked my keyboard off the desk. I'll take that as a 'no'.",
        "That's so creative! Unfortunately, I'm not. I can only build houses, towers, and villages. Limited imagination, endless excuses!",
        "I tried to build that but accidentally made a black hole instead. Let's stick to houses and towers for safety reasons!",
        "My block supply is running low! I only have enough for houses, towers, and villages right now. Supply chain issues, you know?",
      ];

      // Function to add message to the chat history
      function addMessage(message, isUser = false) {
        const messageContainer = document.createElement("div");
        messageContainer.className = isUser
          ? "message-container user-message-container"
          : "message-container bot-message-container";

        const messageElement = document.createElement("div");
        messageElement.className = isUser ? "user-message" : "bot-message";
        messageElement.innerHTML = message;

        messageContainer.appendChild(messageElement);
        messageHistory.appendChild(messageContainer);
        messageHistory.scrollTop = messageHistory.scrollHeight;
      }

      // Function to get random response from array
      function getRandomResponse(responseArray) {
        const randomIndex = Math.floor(Math.random() * responseArray.length);
        return responseArray[randomIndex];
      }

      // Function to send message to server
      function sendMessage() {
        const message = messageInput.value.trim();
        if (message) {
          addMessage(message, true);

          // Send to server
          fetch("/send_message", {
            method: "POST",
            headers: {
              "Content-Type": "application/x-www-form-urlencoded",
            },
            body: `message=${encodeURIComponent(message)}`,
          })
            .then((response) => response.json())
            .then((data) => {
              // Get the appropriate funny response based on the prompt
              let funnyResponse;

              if (message.toLowerCase().includes("house")) {
                funnyResponse = funnyResponses["house"];
              } else if (message.toLowerCase().includes("tower")) {
                funnyResponse = funnyResponses["tower"];
              } else if (message.toLowerCase().includes("village")) {
                funnyResponse = funnyResponses["village"];
              } else {
                // Get a random funny response for unrecognized requests
                funnyResponse = getRandomResponse(defaultFunnyResponses);
              }

              // Display the funny response to the user
              addMessage(funnyResponse);

              // Log the actual JSON response to the console
              console.log("Server JSON response:", data);
            })
            .catch((error) => {
              addMessage(
                `Oops! Something went wrong. Maybe the cats knocked over the server again?`
              );
              console.error("Error:", error);
            });

          messageInput.value = "";
        }
      }

      // Event listeners
      sendBtn.addEventListener("click", sendMessage);
      messageInput.addEventListener("keypress", (e) => {
        if (e.key === "Enter") {
          sendMessage();
        }
      });
    </script>
  </body>
</html>
